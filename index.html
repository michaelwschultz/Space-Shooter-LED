<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://unpkg.com/tachyons/css/tachyons.min.css">
<style>
    .wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-between;
    }
    .hidden {
        visibility: hidden;
    }
</style>

<body class="sans-serif pa2 bg-navy" style="height: 100%;">

    <div class="wrapper">
        <div>
            <h1 class="lightest-blue">LED Board Simulator</h1>
            <div id="board-lights" class="absolute"></div>
            <div id="board"></div>
        </div>
    </div>


    <!-- Imports -->
    <script src="simulator.js"></script>
    <script src="classes.js"></script>
    <script src="shapes.js"></script>

    <script>
        //** Variables and setup **//
        // generate an alphabet
        let alphabet = "abcdefghijklmnopqrstuvwxyz".split('');
        let bulletShotOrigin = null;
        let bulletLocation = null;
        let bulletFired = false;
        let bulletCount = 0;
        let shipColor = "";
        let fps = 30;
        let frame = 0;
        let grid = {height: 16, width: 32};

        const ledColor = "bg-dark-blue";


        getBoard("board", "slot", "bg-dark-blue");
        getBoard("board-lights", "light");

        let myShip = new Ship(new Location("i", 0), "bg-yellow");

        function render(myShip, enemy) {

            // cleanup all unused lights
            for (r = 0; r < grid.height; r++) { 
                for (c = 0; c < grid.width; c++) {
                    let led = (new Location(alphabet[r], c))
                    turnOff(led);
                }
            }

            // Turn on lights in the simulator

            turnOn(myShip.location, myShip.color);

            new Shape(shapeSmallEnemy).placeShape();

            new Shape(shapeLargeEnemy).placeShape();


            // TODO Create an array of game objects, which define their position and color
            // for loop through all objects...
            // turn on leds accordingly.. if there is nothing in that space turn the led off


            // Random colors that can be turned on manually
            // turnOn(new Location("h", 16), "bg-light-blue");
            // turnOn(new Location("b", 7), "bg-light-blue");
        }

        // Render game at designated fps
        setInterval(render.bind(null, myShip), 1000 / fps);

        // keyboard controls
        document.onkeydown = function(e) {
            switch (e.keyCode) {
                case 32: // spacebar
                    new Bullet(myShip.location, "bg-red", 30).fire();
                    break;
                case 38: // up
                    myShip.moveUp();
                    break;
                case 87: // w
                    myShip.moveUp();
                    break;
                case 40: // down
                    myShip.moveDown();
                    break;
                case 83: // s
                    myShip.moveDown();
                    break;
                case 37: // left
                    myShip.moveLeft();
                    break;
                case 39: // right
                    myShip.moveRight();
                    break;
            }
        };

    </script>
</body>